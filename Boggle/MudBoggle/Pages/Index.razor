@using MudBoggle.Widgets
@using BGL_Library

@page "/"

<PageTitle>Boggle</PageTitle>


<MudContainer>

	<MudStack Justify="Justify.Center">

		<MudToolBar Class="ma-6">
			<MudSpacer></MudSpacer>
			<MudText Typo="Typo.h3">Boggle</MudText>
			<MudSpacer></MudSpacer>
		</MudToolBar>


		<MudToolBar>
			<MudTextField @bind-Value="TextValue" Variant="Variant.Outlined"></MudTextField>
			<MudButton Class="ma-6" OnClick="@GuessWord" Variant="Variant.Filled" Color="Color.Primary">Submit</MudButton>
		</MudToolBar>


		<MudGrid>

			<MudItem xs="3">
				<MudButton Variant="Variant.Filled" Disabled="true">3:00</MudButton>
				<MudButton Variant="Variant.Filled" Disabled="true">@Score</MudButton>
			</MudItem>

			<MudItem xs="6">
					<MudText Align="Align.Center">@Feedback</MudText>
			</MudItem>

			<MudItem xs="3">
					<MudButton OnClick="@NewGame" Variant="Variant.Filled">New Game</MudButton>
			</MudItem>

		</MudGrid>


		<BoggleBoard Game="@Game"></BoggleBoard>

	</MudStack>

</MudContainer>


	@code {

	public string TextValue = "";

	public BoggleGame Game = BoggleGame.GetInstance();

	public int Points {get { return Game.points; } }

	public string Feedback = "Guess a word!";

	public string Score
	{
		get
		{
			return $"Score: {Points}";
		}

	}

	void NewGame()
	{
		TextValue = "";
		Feedback = "";
		Game.NewGrid();
	}

	void GuessWord()
	{
		string guess = TextValue;
		GuessOutcome outcome = Game.SubmitGuess(guess);
		Feedback = GetFeedbackString(guess, outcome);
		TextValue = "";
	}

	string GetFeedbackString(string guess, GuessOutcome outcome)
	{
		switch (outcome)
		{
			case GuessOutcome.AlreadyFound:
				return $"You've already found '{guess}'.";

			case GuessOutcome.NotInBoard:
				return $"We couldn't find '{guess}'  in the board.";

			case GuessOutcome.Correct:
				return $"Well done! You found '{guess}'.";

			default:
				return $"'{guess}' isn't a valid word in our Boggle dictionary.";
		}
	}
}